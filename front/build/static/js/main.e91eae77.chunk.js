(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e){e.exports={TEACHER_PERMISSION:0,ADMIN_PERMISSION:1}},29:function(e,t,n){e.exports=n(58)},36:function(e,t,n){},38:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},47:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(15),o=n.n(s),c=n(62),i=(n(34),n(5)),l=n(6),u=n(8),m=n(7),d=n(9),f=n(60),g=n(61),h=(n(36),n(4)),p=(n(38),n(40),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("h1",null,"Home page")}}]),t}(r.a.Component)),b=n(12),v=n(16),E=(n(42),n(2)),y=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={isOpen:e.isOpen||!1,message:e.message||""},n.toggle=n.toggle.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.setState(function(e){return{isOpen:!e.isOpen,message:t}}),"function"===typeof this.props.toggle&&this.props.toggle(e,t,this.props.title)}},{key:"componentWillReceiveProps",value:function(e){this.setState({isOpen:e.isOpen||!1,message:e.message||""})}},{key:"render",value:function(){return r.a.createElement(E.i,{isOpen:this.state.isOpen,toggle:this.toggle,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggle},this.props.title||"Title"),r.a.createElement(E.j,null,r.a.createElement("div",{className:"h2 text-center"},this.state.message)),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"secondary",onClick:this.toggle},"Close")))}}]),t}(r.a.Component),j=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={isOpen:e.isOpen||!1,message:e.message||""},n.toggle=n.toggle.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.setState(function(e){return{isOpen:!e.isOpen,message:t}}),"function"===typeof this.props.toggle&&this.props.toggle(e,t,this.props.title)}},{key:"componentWillReceiveProps",value:function(e){this.setState({isOpen:e.isOpen||!1,message:e.message||""})}},{key:"render",value:function(){return r.a.createElement(E.i,{isOpen:this.state.isOpen,toggle:this.toggle,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggle},this.props.title),r.a.createElement(E.j,null,r.a.createElement("div",{className:"h2 text-center"},this.state.message)),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"primary",onClick:this.props.confirm},"Yes"),r.a.createElement(E.b,{color:"secondary",onClick:this.toggle},"No")))}}]),t}(r.a.Component),O=n(14),k=n.n(O),S=n(27),w=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"convertUrlToImage",value:function(e){return new Promise(function(t,n){var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e,n=document.createElement("CANVAS"),r=n.getContext("2d");n.height=a.height,n.width=a.width,r.drawImage(a,0,0),e=n.toDataURL(),t(e)},a.onerror=n,a.src=e})}},{key:"convertFileToImage",value:function(e){return new Promise(function(t,n){var a=new FileReader;e||n(),a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)})}}]),e}(),C=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).fields=["name","surname","email","phone","username","password","password-retype","privilege"],n.state={users:[],userData:n.fields.concat(["avatar"]).reduce(function(e,t){return e[t]="",e},{}),selectedUser:!1,userForm:!1,alert:{isOpen:!1,message:"",title:"Warning"},confirm:{isOpen:!1,message:"",action:"",title:"Confirm"}},n.passRetype=r.a.createRef(),n.avatar=r.a.createRef(),n.toggleForm=n.toggleForm.bind(Object(h.a)(Object(h.a)(n))),n.toggleAlert=n.toggleAlert.bind(Object(h.a)(Object(h.a)(n))),n.toggleConfirm=n.toggleConfirm.bind(Object(h.a)(Object(h.a)(n))),n.editUser=n.editUser.bind(Object(h.a)(Object(h.a)(n))),n.addUser=n.addUser.bind(Object(h.a)(Object(h.a)(n))),n.deleteUser=n.deleteUser.bind(Object(h.a)(Object(h.a)(n))),n.confirm=n.confirm.bind(Object(h.a)(Object(h.a)(n))),n.getUsers(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"editUser",value:function(e){var t=this,n=e.target.dataset.id;e.preventDefault(),Y.getUser(n).then(function(e){w.convertUrlToImage(e.avatar).then(function(t){e.avatar=t},function(){}).then(function(){return t.toggleForm(null,n,e)})})}},{key:"saveChanges",value:function(){var e=this,t=this.collectData();t&&Y.editUser(this.state.selectedUser,t).then(function(){e.toggleForm(),e.toggleAlert(null,"User updated successfully","Congrats"),e.getUsers()})}},{key:"deleteUser",value:function(){var e=this;Y.deleteUser(this.state.selectedUser).then(function(){e.toggleForm(),e.toggleAlert(null,"User deleted successfully","Congrats"),e.getUsers()})}},{key:"addUser",value:function(){var e=this,t=this.collectData();t&&Y.addUser(t).then(function(){e.toggleForm(),e.toggleAlert(null,"User created successfully","Congrats"),e.getUsers()},function(e){return console.error(e)})}},{key:"getUsers",value:function(){var e=this;Y.getUsers().then(function(t){return e.setState({users:t})})}},{key:"toggleForm",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(a){return{userForm:!a.userForm,selectedUser:t,userData:e.fields.concat(["avatar"]).reduce(function(e,t){return e[t]=e[t]||0===e[t]?String(e[t]):"",e},n||{})}})}},{key:"toggleAlert",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.alert.title;this.setState(function(n){return{alert:Object.assign(n.alert,{isOpen:!n.alert.isOpen,message:e,title:t})}})}},{key:"toggleConfirm",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.state.confirm.title;this.setState(function(a){return{confirm:Object.assign(a.confirm,{isOpen:!a.confirm.isOpen,message:e,action:t,title:n})}})}},{key:"confirm",value:function(){switch(this.state.confirm.action){case"DELETE_USER":this.deleteUser()}this.toggleConfirm()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.b,{className:"add-button",color:"primary",onClick:this.toggleForm},"Add new user"),r.a.createElement(E.g,{className:"users-list"},this.state.users.map(function(t){return r.a.createElement(E.h,{onClick:e.editUser,tag:"a",href:"#",key:t.id,"data-id":t.id},"".concat(t.name," ").concat(t.surname))})),r.a.createElement(E.i,{isOpen:this.state.userForm,toggle:this.toggleForm,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggleForm},"User form"),r.a.createElement(E.j,null,r.a.createElement(E.c,null,r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"name"},"Name"),r.a.createElement(E.e,{value:this.state.userData.name,onChange:function(t){return e.collectState("name",t.target.value)},type:"text",name:"name",id:"name",placeholder:"Name"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"surname"},"Surname"),r.a.createElement(E.e,{value:this.state.userData.surname,onChange:function(t){return e.collectState("surname",t.target.value)},type:"text",name:"surname",id:"surname",placeholder:"Surname"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"email"},"Email"),r.a.createElement(E.e,{value:this.state.userData.email,onChange:function(t){return e.collectState("email",t.target.value)},type:"email",name:"email",id:"email",placeholder:"Email"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"phone"},"Phone"),r.a.createElement(k.a,{value:this.state.userData.phone,onChange:function(t){return e.collectState("phone",t.target.value)},mask:"099-99-99-99",maskChar:" "},function(e){return r.a.createElement(E.e,Object.assign({},e,{type:"text",name:"phone",id:"phone",placeholder:"Phone"}))})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"username"},"Username"),r.a.createElement(E.e,{value:this.state.userData.username,onChange:function(t){e.collectState("username",t.target.value)},type:"text",name:"username",id:"username",placeholder:"Username"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"password"},"Password"),r.a.createElement(E.e,{value:this.state.userData.password,onChange:function(t){e.collectState("password",t.target.value)},type:"password",name:"password",id:"password",placeholder:"Password"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"password-retype"},"Confirm Password"),r.a.createElement(E.e,{value:this.state.userData["password-retype"],innerRef:this.passRetype,onChange:function(t){e.watchPassRetype(),e.collectState("password-retype",t.target.value)},type:"password",name:"password-retype",id:"password-retype",placeholder:"Confirm Password"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"privilege"},"Privilege"),r.a.createElement(E.e,{value:this.state.userData.privilege,onChange:function(t){return e.collectState("privilege",t.target.value)},type:"select",name:"privilege",id:"privilege"},r.a.createElement("option",{disabled:!0,value:""},"Select privilege"),r.a.createElement("option",{value:"0"},"Teacher"),r.a.createElement("option",{value:"1"},"Administrator"))),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"avatar"},"Avatar"),r.a.createElement(E.e,{accept:"image/*",onChange:function(n){return t.changeAvatar(n).then(function(t){return e.collectState("avatar",t)})},type:"file",name:"avatar",id:"avatar"}),r.a.createElement("div",{hidden:!Boolean(this.state.userData.avatar)},r.a.createElement("img",{src:this.state.userData.avatar,className:"img-fluid avatar",ref:this.avatar,alt:"Avatar"}))))),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"primary",onClick:function(){e.state.selectedUser?e.saveChanges():e.addUser()}},this.state.selectedUser?"Save changes":"Add user")," ",this.state.selectedUser&&r.a.createElement(E.b,{color:"danger",onClick:function(t){e.toggleConfirm(t,"Are you sure you want to delete this user","DELETE_USER")}},"Delete"),r.a.createElement(E.b,{color:"secondary",onClick:this.toggleForm},"Cancel"))),r.a.createElement(y,{toggle:this.toggleAlert,isOpen:this.state.alert.isOpen,message:this.state.alert.message,title:this.state.alert.title}),r.a.createElement(j,{toggle:this.toggleConfirm,isOpen:this.state.confirm.isOpen,message:this.state.confirm.message,title:this.state.confirm.title,confirm:this.confirm}))}},{key:"collectData",value:function(){var e=this,t=this.fields.find(function(t){return!e.state.userData[t]});if(t)this.toggleAlert(null,"".concat(t.replace(/^./,function(e){return e.toUpperCase()})," is required"));else if(S.validate(String(this.state.userData.email))){if(this.state.userData.password===this.state.userData["password-retype"]){var n=Object(v.a)({},this.state.userData);return delete n.userForm,delete n.alert,n.avatar=n.avatar||null,n}this.toggleAlert(null,"Passwords don't match")}else this.toggleAlert(null,"Invalid mail")}},{key:"collectState",value:function(e,t){this.setState(function(n){return{userData:Object.assign(n.userData,Object(b.a)({},e,t))}})}},{key:"watchPassRetype",value:function(){this.passRetype.current.style.border=this.passRetype.current.value!==this.state.userData.password?"1px solid red":"initial"}}],[{key:"changeAvatar",value:function(e){return w.convertFileToImage(e.target.files[0])}}]),t}(r.a.Component);n(47);function D(e){var t=new URLSearchParams;for(var n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return"?"+t.toString()}var A=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"get",value:function(t){if("object"!==typeof t)throw new Error("Invalid argument");return t.method="GET",e.request(t)}},{key:"post",value:function(t){if("object"!==typeof t)throw new Error("Invalid argument");return t.method="POST",e.request(t)}},{key:"put",value:function(t){if("object"!==typeof t)throw new Error("Invalid argument");return t.method="PUT",e.request(t)}},{key:"delete",value:function(t){if("object"!==typeof t)throw new Error("Invalid argument");return t.method="DELETE",e.request(t)}},{key:"request",value:function(e){!function(e){var t=e.url;if("string"!==typeof t)throw new Error("Invalid url");if("object"===typeof e.params&&(t+=D(e.params),delete e.params),"object"===typeof e.body)if("object"===typeof e.headers)switch(e.headers["Content-Type"]){default:e.headers["Content-Type"]="application/json";case"application/json":e.body=JSON.stringify(e.body);break;case"multipart/form-data":case"application/x-www-form-urlencoded":e.body=e.body instanceof FormData?e.body:D(e.body)}else e.headers["Content-Type"]="application/json",e.body=JSON.stringify(e.body);e.mode=e.mode||"cors",e.url=t}(e);var t=e.url;return new Promise(function(n,a){fetch(t,e).then(function(e){e.json().then(function(t){e.ok?n(t):a(t)})},function(e){a(e)})})}}]),e}(),N=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getStudents",value:function(e){e&&"object"===typeof e||(e={});var t={};return["limit","offset","filter"].forEach(function(n){n in e&&(t[n]=e[n])}),new Promise(function(e,n){A.get({url:"".concat(_,"/students"),headers:X(),params:t}).then(function(t){return e(t)},function(e){return n(e)})})}},{key:"getStudent",value:function(e){return isNaN(e)?Promise.reject({message:"Invalid id"}):new Promise(function(t,n){A.get({url:"".concat(_,"/students/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"addStudent",value:function(e){return new Promise(function(t,n){if("object"!==typeof e)throw new Error("Object required");A.post({url:"".concat(_,"/students"),body:e,headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"editStudent",value:function(e,t){return new Promise(function(n,a){if("object"!==typeof t)throw new Error("Object required");if(isNaN(e))return Promise.reject({message:"Invalid id"});A.put({url:"".concat(_,"/students/").concat(e),body:t,headers:X()}).then(function(e){return n(e)},function(e){return a(e)})})}},{key:"deleteStudent",value:function(e){return new Promise(function(t,n){if(isNaN(e))return Promise.reject({message:"Invalid id"});A.delete({url:"".concat(_,"/students/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}}]),e}(),I=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).fields=["name","surname","remark","phone"],n.state={students:[],studentData:n.fields.reduce(function(e,t){return e[t]="",e},{}),selectedStudent:!1,studentForm:!1,alert:{isOpen:!1,message:"",title:"Warning"},confirm:{isOpen:!1,message:"",action:"",title:"Confirm"},filter:0},n.toggleForm=n.toggleForm.bind(Object(h.a)(Object(h.a)(n))),n.toggleAlert=n.toggleAlert.bind(Object(h.a)(Object(h.a)(n))),n.toggleConfirm=n.toggleConfirm.bind(Object(h.a)(Object(h.a)(n))),n.editStudent=n.editStudent.bind(Object(h.a)(Object(h.a)(n))),n.addStudent=n.addStudent.bind(Object(h.a)(Object(h.a)(n))),n.deleteStudent=n.deleteStudent.bind(Object(h.a)(Object(h.a)(n))),n.confirm=n.confirm.bind(Object(h.a)(Object(h.a)(n))),n.getStudents(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.state.filter!==t.filter&&this.getStudents({filter:t.filter})}},{key:"editStudent",value:function(e){var t=this,n=e.target.dataset.id;e.preventDefault(),N.getStudent(n).then(function(e){t.toggleForm(null,n,e)})}},{key:"saveChanges",value:function(){var e=this,t=this.collectData();t&&N.editStudent(this.state.selectedStudent,t).then(function(){e.toggleForm(),e.toggleAlert(null,"Student updated successfully","Congrats"),e.getStudents()})}},{key:"deleteStudent",value:function(){var e=this;N.deleteStudent(this.state.selectedStudent).then(function(t){e.toggleForm(),e.toggleAlert(null,t.message,"Congrats"),e.getStudents()})}},{key:"archiveStudent",value:function(){var e=this,t=this.collectData();t&&(t.archived=Number(this.state.studentData.archived)?0:1,N.editStudent(this.state.selectedStudent,t).then(function(){e.toggleForm(),e.toggleAlert(null,"Student deleted successfully","Congrats"),e.getStudents()}))}},{key:"addStudent",value:function(){var e=this,t=this.collectData();t&&N.addStudent(t).then(function(t){e.toggleForm(),e.toggleAlert(null,t.message,"Congrats"),e.getStudents()},function(e){return console.error(e)})}},{key:"getStudents",value:function(){var e=this;N.getStudents({filter:this.state.filter}).then(function(t){return e.setState({students:t})})}},{key:"toggleForm",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(a){return{studentForm:!a.studentForm,selectedStudent:t,studentData:n||e.fields.reduce(function(e,t){return e[t]="",e},{})}})}},{key:"toggleAlert",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.alert.title;this.setState(function(n){return{alert:Object.assign(n.alert,{isOpen:!n.alert.isOpen,message:e,title:t})}})}},{key:"toggleConfirm",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.state.confirm.title;this.setState(function(a){return{confirm:Object.assign(a.confirm,{isOpen:!a.confirm.isOpen,message:e,action:t,title:n})}})}},{key:"confirm",value:function(){switch(this.state.confirm.action){case"DELETE_USER":this.deleteStudent();break;case"ARCHIVE_USER":this.archiveStudent()}this.toggleConfirm()}},{key:"render",value:function(){var e=this,t=this.state.studentData.archived?"Activate":"Archive",n=this.state.students.filter(function(t){return!e.state.searchText||t.name.toLowerCase().startsWith(e.state.searchText.toLowerCase())||t.surname.toLowerCase().startsWith(e.state.searchText.toLowerCase())}).map(function(t,n){return r.a.createElement(E.h,{onClick:e.editStudent,tag:"a",href:"#",key:t.id,"data-id":t.id},"".concat(n+1,". ").concat(t.name," ").concat(t.surname))});return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.c,{inline:!0},r.a.createElement(E.d,null,r.a.createElement(E.e,{value:this.state.filter,onChange:function(t){return e.setState({filter:Number(t.target.value)})},type:"select",name:"surname",id:"surname"},r.a.createElement("option",{value:H.ACTIVE},"Active"),r.a.createElement("option",{value:H.ARCHIVED},"Archived"),r.a.createElement("option",{value:H.PENDING},"Pending"))),r.a.createElement(E.d,null,r.a.createElement(E.b,{className:"add-button",color:"primary",onClick:this.toggleForm},"Add new student"))),r.a.createElement(E.d,{className:"search"},r.a.createElement(E.e,{value:this.state.searchText,onChange:function(t){return e.setState({searchText:t.target.value})},type:"text",placeholder:"Search"})),r.a.createElement("div",{className:"rows-count"},"Students count ",n.length),r.a.createElement(E.g,{className:"students-list"},n),r.a.createElement(E.i,{isOpen:this.state.studentForm,toggle:this.toggleForm,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggleForm},"Student form"),r.a.createElement(E.j,null,r.a.createElement(E.c,null,r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"name"},"Name"),r.a.createElement(E.e,{value:this.state.studentData.name,onChange:function(t){return e.collectState("name",t.target.value)},type:"text",name:"name",id:"name",placeholder:"Name"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"surname"},"Surname"),r.a.createElement(E.e,{value:this.state.studentData.surname,onChange:function(t){return e.collectState("surname",t.target.value)},type:"text",name:"surname",id:"surname",placeholder:"Surname"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"remark"},"Remark"),r.a.createElement(E.e,{value:this.state.studentData.remark,onChange:function(t){return e.collectState("remark",t.target.value)},type:"text",name:"remark",id:"remark",placeholder:"Remark"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"phone"},"Phone"),r.a.createElement(k.a,{value:this.state.studentData.phone,onChange:function(t){return e.collectState("phone",t.target.value)},mask:"099-99-99-99",maskChar:" "},function(e){return r.a.createElement(E.e,Object.assign({},e,{type:"text",name:"phone",id:"phone",placeholder:"Phone"}))})))),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"primary",onClick:function(){e.state.selectedStudent?e.saveChanges():e.addStudent()}},this.state.selectedStudent?"Save changes":"Add student")," ",this.state.selectedStudent&&r.a.createElement(r.a.Fragment,null,r.a.createElement(E.b,{color:"warning",onClick:function(n){e.toggleConfirm(n,"Are you sure you want to ".concat(t.toLowerCase()," this student"),"ARCHIVE_USER")}},t),r.a.createElement(E.b,{color:"danger",onClick:function(t){e.toggleConfirm(t,"Are you sure you want to delete this student","DELETE_USER")}},"Delete")),r.a.createElement(E.b,{color:"secondary",onClick:this.toggleForm},"Cancel"))),r.a.createElement(y,{toggle:this.toggleAlert,isOpen:this.state.alert.isOpen,message:this.state.alert.message,title:this.state.alert.title}),r.a.createElement(j,{toggle:this.toggleConfirm,isOpen:this.state.confirm.isOpen,message:this.state.confirm.message,title:this.state.confirm.title,confirm:this.confirm}))}},{key:"collectData",value:function(){var e=this,t=this.fields.find(function(t){return"remark"!==t&&!e.state.studentData[t]});if(!t)return Object(v.a)({},this.state.studentData,{remark:this.state.studentData.remark||""});this.toggleAlert(null,"".concat(t.replace(/^./,function(e){return e.toUpperCase()})," is required"))}},{key:"collectState",value:function(e,t){this.setState(function(n){return{studentData:Object.assign(n.studentData,Object(b.a)({},e,t))}})}}]),t}(r.a.Component),F=(n(49),function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getSubjects",value:function(e){e&&"object"===typeof e||(e={});var t={};return["limit","offset"].forEach(function(n){n in e&&(t[n]=e[n])}),new Promise(function(e,n){A.get({url:"".concat(_,"/subjects"),headers:X(),params:t}).then(function(t){return e(t)},function(e){return n(e)})})}},{key:"getSubject",value:function(e){return isNaN(e)?Promise.reject({message:"Invalid id"}):new Promise(function(t,n){A.get({url:"".concat(_,"/subjects/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"addSubject",value:function(e){return new Promise(function(t,n){if("object"!==typeof e)throw new Error("Object required");A.post({url:"".concat(_,"/subjects"),body:e,headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"editSubject",value:function(e,t){return new Promise(function(n,a){if("object"!==typeof t)throw new Error("Object required");if(isNaN(e))return Promise.reject({message:"Invalid id"});A.put({url:"".concat(_,"/subjects/").concat(e),body:t,headers:X()}).then(function(e){return n(e)},function(e){return a(e)})})}},{key:"deleteSubject",value:function(e){return new Promise(function(t,n){if(isNaN(e))return Promise.reject({message:"Invalid id"});A.delete({url:"".concat(_,"/subjects/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}}]),e}()),U=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).fields=["name"],n.state={subjects:[],subjectData:n.fields.reduce(function(e,t){return e[t]="",e},{}),selectedSubject:!1,subjectForm:!1,alert:{isOpen:!1,message:"",title:"Warning"},confirm:{isOpen:!1,message:"",action:"",title:"Confirm"}},n.toggleForm=n.toggleForm.bind(Object(h.a)(Object(h.a)(n))),n.toggleAlert=n.toggleAlert.bind(Object(h.a)(Object(h.a)(n))),n.toggleConfirm=n.toggleConfirm.bind(Object(h.a)(Object(h.a)(n))),n.editSubject=n.editSubject.bind(Object(h.a)(Object(h.a)(n))),n.addSubject=n.addSubject.bind(Object(h.a)(Object(h.a)(n))),n.deleteSubject=n.deleteSubject.bind(Object(h.a)(Object(h.a)(n))),n.confirm=n.confirm.bind(Object(h.a)(Object(h.a)(n))),n.getSubjects(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"editSubject",value:function(e){var t=this,n=e.target.dataset.id;e.preventDefault(),F.getSubject(n).then(function(e){t.toggleForm(null,n,e)})}},{key:"saveChanges",value:function(){var e=this,t=this.collectData();t&&F.editSubject(this.state.selectedSubject,t).then(function(){e.toggleForm(),e.toggleAlert(null,"Subject updated successfully","Congrats"),e.getSubjects()})}},{key:"deleteSubject",value:function(){var e=this;F.deleteSubject(this.state.selectedSubject).then(function(){e.toggleForm(),e.toggleAlert(null,"Subject deleted successfully","Congrats"),e.getSubjects()})}},{key:"addSubject",value:function(){var e=this,t=this.collectData();t&&F.addSubject(t).then(function(){e.toggleForm(),e.toggleAlert(null,"Subject created successfully","Congrats"),e.getSubjects()},function(e){return console.error(e)})}},{key:"getSubjects",value:function(){var e=this;F.getSubjects().then(function(t){return e.setState({subjects:t})})}},{key:"toggleForm",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(a){return{subjectForm:!a.subjectForm,selectedSubject:t,subjectData:n||e.fields.reduce(function(e,t){return e[t]="",e},{})}})}},{key:"toggleAlert",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.alert.title;this.setState(function(n){return{alert:Object.assign(n.alert,{isOpen:!n.alert.isOpen,message:e,title:t})}})}},{key:"toggleConfirm",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.state.confirm.title;this.setState(function(a){return{confirm:Object.assign(a.confirm,{isOpen:!a.confirm.isOpen,message:e,action:t,title:n})}})}},{key:"confirm",value:function(){switch(this.state.confirm.action){case"DELETE_USER":this.deleteSubject()}this.toggleConfirm()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.b,{className:"add-button",color:"primary",onClick:this.toggleForm},"Add new subject"),r.a.createElement("div",{className:"rows-count"},"Subjects count ",this.state.subjects.length),r.a.createElement(E.g,{className:"subjects-list"},this.state.subjects.map(function(t,n){return r.a.createElement(E.h,{onClick:e.editSubject,tag:"a",href:"#",key:t.id,"data-id":t.id},"".concat(n+1,". ").concat(t.name))})),r.a.createElement(E.i,{isOpen:this.state.subjectForm,toggle:this.toggleForm,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggleForm},"Subject form"),r.a.createElement(E.j,null,r.a.createElement(E.c,null,r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"name"},"Name"),r.a.createElement(E.e,{value:this.state.subjectData.name,onChange:function(t){return e.collectState("name",t.target.value)},type:"text",name:"name",id:"name",placeholder:"Name"})))),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"primary",onClick:function(){e.state.selectedSubject?e.saveChanges():e.addSubject()}},this.state.selectedSubject?"Save changes":"Add subject")," ",this.state.selectedSubject&&r.a.createElement(E.b,{color:"danger",onClick:function(t){e.toggleConfirm(t,"Are you sure you want to delete this subject","DELETE_USER")}},"Delete"),r.a.createElement(E.b,{color:"secondary",onClick:this.toggleForm},"Cancel"))),r.a.createElement(y,{toggle:this.toggleAlert,isOpen:this.state.alert.isOpen,message:this.state.alert.message,title:this.state.alert.title}),r.a.createElement(j,{toggle:this.toggleConfirm,isOpen:this.state.confirm.isOpen,message:this.state.confirm.message,title:this.state.confirm.title,confirm:this.confirm}))}},{key:"collectData",value:function(){var e=this,t=this.fields.find(function(t){return!e.state.subjectData[t]});if(!t)return Object(v.a)({},this.state.subjectData);this.toggleAlert(null,"".concat(t.replace(/^./,function(e){return e.toUpperCase()})," is required"))}},{key:"collectState",value:function(e,t){this.setState(function(n){return{subjectData:Object.assign(n.subjectData,Object(b.a)({},e,t))}})}}]),t}(r.a.Component),P=n(18);n(51);function G(e){var t=e.split(":"),n=Object(P.a)(t,2),a=n[0],r=n[1];return!/\D/.test(a+r)&&Number(a)<24&&Number(r)<60}function T(e,t){if(e.substr(0,5)===t.substr(0,5))return 0;var n=e.split(":"),a=Object(P.a)(n,2),r=a[0],s=a[1],o=t.split(":"),c=Object(P.a)(o,2),i=c[0],l=c[1];return r=Number(r),s=Number(s),i=Number(i),l=Number(l),r>i||r===i&&s>l?1:-1}var R=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getGroups",value:function(e){e&&"object"===typeof e||(e={});var t={};return["limit","offset"].forEach(function(n){n in e&&(t[n]=e[n])}),new Promise(function(e,n){A.get({url:"".concat(_,"/groups"),headers:X(),params:t}).then(function(t){return e(t)},function(e){return n(e)})})}},{key:"getGroup",value:function(e){return isNaN(e)?Promise.reject({message:"Invalid id"}):new Promise(function(t,n){A.get({url:"".concat(_,"/groups/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"addGroup",value:function(e){return new Promise(function(t,n){if("object"!==typeof e)throw new Error("Object required");A.post({url:"".concat(_,"/groups"),body:e,headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"editGroup",value:function(e,t){return new Promise(function(n,a){if("object"!==typeof t)throw new Error("Object required");if(isNaN(e))return Promise.reject({message:"Invalid id"});A.put({url:"".concat(_,"/groups/").concat(e),body:t,headers:X()}).then(function(e){return n(e)},function(e){return a(e)})})}},{key:"deleteGroup",value:function(e){return new Promise(function(t,n){if(isNaN(e))return Promise.reject({message:"Invalid id"});A.delete({url:"".concat(_,"/groups/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"getGroupsData",value:function(){return new Promise(function(e,t){A.get({url:"".concat(_,"/groups/all"),headers:X()}).then(function(t){return e(t)},function(e){return t(e)})})}}]),e}(),x=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getWeekDays",value:function(){return new Promise(function(e,t){A.get({url:"".concat(_,"/date/weekDays"),headers:X()}).then(function(t){return e(t)},function(e){return t(e)})})}}]),e}(),L=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).fields=["name","userId","subjectId","studentId","dayId"],n.state={groups:[],groupData:n.fields.reduce(function(e,t){return e[t]="",e},{}),selectedGroup:!1,groupForm:!1,alert:{isOpen:!1,message:"",title:"Warning"},confirm:{isOpen:!1,message:"",action:"",title:"Confirm"},students:[],users:[],subjects:[],weekDays:[]},n.toggleForm=n.toggleForm.bind(Object(h.a)(Object(h.a)(n))),n.toggleAlert=n.toggleAlert.bind(Object(h.a)(Object(h.a)(n))),n.toggleConfirm=n.toggleConfirm.bind(Object(h.a)(Object(h.a)(n))),n.editGroup=n.editGroup.bind(Object(h.a)(Object(h.a)(n))),n.addGroup=n.addGroup.bind(Object(h.a)(Object(h.a)(n))),n.deleteGroup=n.deleteGroup.bind(Object(h.a)(Object(h.a)(n))),n.confirm=n.confirm.bind(Object(h.a)(Object(h.a)(n))),n.selectStudent=n.selectStudent.bind(Object(h.a)(Object(h.a)(n))),n.selectDay=n.selectDay.bind(Object(h.a)(Object(h.a)(n))),n.getGroups(),n.init(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"init",value:function(){var e=this;Promise.all([Y.getUsers(),F.getSubjects(),N.getStudents(),x.getWeekDays()]).then(function(t){var n=Object(P.a)(t,4),a=n[0],r=n[1],s=n[2],o=n[3];s.forEach(function(e){return e.selected=!1}),o.forEach(function(e){e.selected=!1,e.startsAt="09:00"}),e.setState({users:a,subjects:r,students:s,weekDays:o})})}},{key:"editGroup",value:function(e){var t=this,n=e.target.dataset.id;e.preventDefault(),R.getGroup(n).then(function(e){Array.isArray(e.students)&&t.state.students.forEach(function(t){e.students.some(function(e){return e===t.id})&&(t.selected=!0)}),Array.isArray(e.days)&&t.state.weekDays.forEach(function(t){var n;(n=e.days.find(function(e){return e.id===t.id}))&&(t.selected=!0,t.startsAt=n.startsAt)}),t.toggleForm(null,n,e)})}},{key:"saveChanges",value:function(){var e=this,t=this.collectData();t&&R.editGroup(this.state.selectedGroup,t).then(function(t){e.toggleForm(),e.toggleAlert(null,t.message,"Congrats"),e.getGroups()},function(t){return e.toggleAlert(null,t.message,"Warning")})}},{key:"deleteGroup",value:function(){var e=this;R.deleteGroup(this.state.selectedGroup).then(function(){e.toggleForm(),e.toggleAlert(null,"Group deleted successfully","Congrats"),e.getGroups()})}},{key:"addGroup",value:function(){var e=this,t=this.collectData();t&&R.addGroup(t).then(function(t){e.toggleForm(),e.toggleAlert(null,t.message,"Congrats"),e.getGroups()},function(t){return e.toggleAlert(null,t.message,"Warning")})}},{key:"getGroups",value:function(){var e=this;R.getGroups().then(function(t){return e.setState({groups:t})})}},{key:"toggleForm",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setState(function(a){return{groupForm:!a.groupForm,selectedGroup:t,groupData:n?Object.assign(a.groupData,n):e.fields.reduce(function(e,t){return e[t]="",e},{}),students:a.groupForm?a.students.map(function(e){return e.selected=!1,e}):a.students,weekDays:a.groupForm?a.weekDays.map(function(e){return e.selected=!1,e.startsAt="09:00",e}):a.weekDays}})}},{key:"toggleAlert",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.alert.title;this.setState(function(n){return{alert:Object.assign(n.alert,{isOpen:!n.alert.isOpen,message:e,title:t})}})}},{key:"toggleConfirm",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.state.confirm.title;this.setState(function(a){return{confirm:Object.assign(a.confirm,{isOpen:!a.confirm.isOpen,message:e,action:t,title:n})}})}},{key:"confirm",value:function(){switch(this.state.confirm.action){case"DELETE_USER":this.deleteGroup()}this.toggleConfirm()}},{key:"selectStudent",value:function(){this.setState(function(e){return{students:e.students.map(function(t){return t.id===parseInt(e.groupData.studentId,10)&&(t.selected=!0),t}),groupData:Object.assign(e.groupData,{studentId:""})}})}},{key:"selectDay",value:function(){this.setState(function(e){return{days:e.weekDays.map(function(t){return t.id===parseInt(e.groupData.dayId,10)&&(t.selected=!0),t}),groupData:Object.assign(e.groupData,{dayId:""})}})}},{key:"deselectStudent",value:function(e){this.setState(function(t){return{students:t.students.map(function(t){return t.id===e&&(t.selected=!1),t})}})}},{key:"deselectDay",value:function(e){this.setState(function(t){return{days:t.weekDays.map(function(t){return t.id===e&&(t.selected=!1),t})}})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.b,{className:"add-button",color:"primary",onClick:this.toggleForm},"Add new group"),r.a.createElement("div",{className:"rows-count"},"Groups count ",this.state.groups.length),r.a.createElement(E.g,{className:"groups-list"},this.state.groups.map(function(t,n){return r.a.createElement(E.h,{onClick:e.editGroup,tag:"a",href:"#",key:t.id,"data-id":t.id},"".concat(n+1,". ").concat(t.name))})),r.a.createElement(E.i,{isOpen:this.state.groupForm,toggle:this.toggleForm,className:"modal-lg"},r.a.createElement(E.l,{toggle:this.toggleForm},"Group form"),r.a.createElement(E.j,null,r.a.createElement(E.c,null,r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"name"},"Name"),r.a.createElement(E.e,{value:this.state.groupData.name,onChange:function(t){return e.collectState("name",t.target.value)},type:"text",name:"name",id:"name",placeholder:"Name"})),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"userId"},"Teacher"),r.a.createElement(E.e,{value:this.state.groupData.userId,onChange:function(t){return e.collectState("userId",t.target.value)},type:"select",name:"userId",id:"userId",placeholder:"Teacher"},r.a.createElement("option",{value:"",disabled:!0},"Select teacher"),this.state.users.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name+" "+e.surname)}))),r.a.createElement(E.d,null,r.a.createElement(E.f,{for:"subjectId"},"Subject"),r.a.createElement(E.e,{value:this.state.groupData.subjectId,onChange:function(t){return e.collectState("subjectId",t.target.value)},type:"select",name:"subjectId",id:"subjectId",placeholder:"Subject"},r.a.createElement("option",{value:"",disabled:!0},"Select subject"),this.state.subjects.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement(E.d,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(E.f,{for:"studentId"},"Students")),r.a.createElement("div",{className:"col-10"},r.a.createElement(E.e,{value:this.state.groupData.studentId,onChange:function(t){return e.collectState("studentId",t.target.value)},type:"select",name:"studentId",id:"studentId",placeholder:"Students"},r.a.createElement("option",{value:"",disabled:!0},"Select student"),this.state.students.filter(function(e){return!e.selected}).map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name+" "+e.surname)}))),r.a.createElement("div",{className:"col-2 text-right"},r.a.createElement(E.b,{color:"success",onClick:this.selectStudent},"Add")))),r.a.createElement(E.g,null,this.state.students.filter(function(e){return e.selected}).map(function(t){return r.a.createElement(E.h,{key:t.id},t.name+" "+t.surname,r.a.createElement(E.a,{onClick:function(){e.deselectStudent(t.id)},color:"danger",className:"float-right delete-icon"},"X"))})),r.a.createElement(E.d,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(E.f,{for:"dayId"},"Week days")),r.a.createElement("div",{className:"col-10"},r.a.createElement(E.e,{value:this.state.groupData.dayId,onChange:function(t){return e.collectState("dayId",t.target.value)},type:"select",name:"dayId",id:"dayId",placeholder:"Week days"},r.a.createElement("option",{value:"",disabled:!0},"Select day"),this.state.weekDays.filter(function(e){return!e.selected}).map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement("div",{className:"col-2 text-right"},r.a.createElement(E.b,{color:"success",onClick:this.selectDay},"Add")))),r.a.createElement(E.g,null,this.state.weekDays.filter(function(e){return e.selected}).map(function(t){return r.a.createElement(E.h,{key:t.id},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"},t.name),r.a.createElement("div",{className:"col-2"},r.a.createElement(k.a,{defaultValue:t.startsAt,innerRef:function(e){return t.startTimeElement=e},mask:"99:99",maskChar:" "},function(e){return r.a.createElement(E.e,Object.assign({},e,{type:"text",name:"startsAt",id:"startsAt"}))})),r.a.createElement("div",{className:"col-6 text-right"},r.a.createElement(E.a,{onClick:function(){e.deselectDay(t.id)},color:"danger",className:"float-right delete-icon"},"X"))))})))),r.a.createElement(E.k,null,r.a.createElement(E.b,{color:"primary",onClick:function(){e.state.selectedGroup?e.saveChanges():e.addGroup()}},this.state.selectedGroup?"Save changes":"Add group")," ",this.state.selectedGroup&&r.a.createElement(E.b,{color:"danger",onClick:function(t){e.toggleConfirm(t,"Are you sure you want to delete this group","DELETE_USER")}},"Delete"),r.a.createElement(E.b,{color:"secondary",onClick:this.toggleForm},"Cancel"))),r.a.createElement(y,{toggle:this.toggleAlert,isOpen:this.state.alert.isOpen,message:this.state.alert.message,title:this.state.alert.title}),r.a.createElement(j,{toggle:this.toggleConfirm,isOpen:this.state.confirm.isOpen,message:this.state.confirm.message,title:this.state.confirm.title,confirm:this.confirm}))}},{key:"collectData",value:function(){var e=this,t=this.fields.find(function(t){return!e.state.groupData[t]&&"studentId"!==t&&"dayId"!==t});if(t)this.toggleAlert(null,"".concat(t.replace("user","teacher").replace(/id/i,"").replace(/^./,function(e){return e.toUpperCase()})," is required"));else{var n=this.state.students.filter(function(e){return e.selected});if(n.length){var a=this.state.weekDays.filter(function(e){return e.selected});if(a.length){if(!a.some(function(t){return G(t.startTimeElement.value)?(t.startsAt=t.startTimeElement.value,!1):(e.toggleAlert(null,"Please input valid time format for ".concat(t.name.toLowerCase())),!0)})){var r=Object(v.a)({},this.state.groupData,{students:n.map(function(e){return e.id}),days:a.map(function(e){return{weekDay:e.id,startsAt:e.startsAt}})});return["studentId","dayId"].forEach(function(e){return delete r[e]}),r}}else this.toggleAlert(null,"Please select at least one week day")}else this.toggleAlert(null,"Please select at least one student")}}},{key:"collectState",value:function(e,t){this.setState(function(n){return{groupData:Object.assign(n.groupData,Object(b.a)({},e,t))}})}}]),t}(r.a.Component),q=(n(53),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={weekDays:[],groupsData:[],users:[],subjects:[],userId:"",subjectId:"",weekDayId:"",startsAt:"",endsAt:""},n.init(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"init",value:function(){var e=this;Promise.all([x.getWeekDays(),R.getGroupsData(),Y.getUsers(),F.getSubjects()]).then(function(t){var n=Object(P.a)(t,4),a=n[0],r=n[1],s=n[2],o=n[3];e.setState({weekDays:a,groupsData:r,users:s,subjects:o})})}},{key:"render",value:function(){var e=this,t=function e(t){if(!t||"object"!==typeof t)return t;var n=Array.isArray(t)?[]:{};for(var a in t)"object"===typeof t[a]&&null!==t[a]?n[a]=e(t[a]):n[a]=t[a];return n}(this.state.groupsData).filter(function(t){return(!e.state.userId||Number(t.id)===Number(e.state.userId))&&(t.subjects=t.subjects.filter(function(t){return(!e.state.subjectId||Number(t.id)===Number(e.state.subjectId))&&(t.groups=t.groups.filter(function(t){return t.days.some(function(t){return(!e.state.weekDayId||Number(t.id)===Number(e.state.weekDayId))&&(!e.state.startsAt||!G(e.state.startsAt)||T(t.startsAt,e.state.startsAt)>=0)&&(!e.state.endsAt||!G(e.state.endsAt)||T(+t.startsAt.substr(0,2)+2+t.startsAt.substr(2),e.state.endsAt)<=0)})}),t.groups.length)}),t.subjects.length)});return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.c,{inline:!0},r.a.createElement(E.d,{className:"col-2 mb-2 mr-sm-2 mb-sm-0"},r.a.createElement(E.f,{for:"userId",className:"mr-sm-2"},"Teacher"),r.a.createElement(E.e,{onChange:function(t){return e.changeState("userId",t.target.value)},type:"select",id:"userId",value:this.state.userId},r.a.createElement("option",{value:""},"Not selected"),this.state.users.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name+" "+e.surname)}))),r.a.createElement(E.d,{className:"col-2 mb-2 mr-sm-2 mb-sm-0"},r.a.createElement(E.f,{for:"subjectId",className:"mr-sm-2"},"Subject"),r.a.createElement(E.e,{onChange:function(t){return e.changeState("subjectId",t.target.value)},type:"select",id:"subjectId",value:this.state.subjectId},r.a.createElement("option",{value:""},"Not selected"),this.state.subjects.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}))),r.a.createElement(E.d,{className:"col-2 mb-2 mr-sm-2 mb-sm-0"},r.a.createElement(E.f,{for:"weekDayId",className:"mr-sm-2"},"Week day"),r.a.createElement(E.e,{onChange:function(t){return e.changeState("weekDayId",t.target.value)},type:"select",id:"weekDayId",value:this.state.weekDayId},r.a.createElement("option",{value:""},"Not selected"),this.state.weekDays.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}))),r.a.createElement(E.d,{className:"col-2 mb-2 mr-sm-2 mb-sm-0"},r.a.createElement(E.f,{for:"startsAt",className:"mr-sm-2"},"Starts at"),r.a.createElement(k.a,{value:this.state.startsAt,onChange:function(t){return e.changeState("startsAt",t.target.value)},mask:"99:99",maskChar:" "},function(e){return r.a.createElement(E.e,Object.assign({},e,{type:"text",name:"startsAt",id:"startsAt"}))})),r.a.createElement(E.d,{className:"col-2 mb-2 mr-sm-2 mb-sm-0"},r.a.createElement(E.f,{for:"endsAt",className:"mr-sm-2"},"Ends at"),r.a.createElement(k.a,{value:this.state.endsAt,onChange:function(t){return e.changeState("endsAt",t.target.value)},mask:"99:99",maskChar:" "},function(e){return r.a.createElement(E.e,Object.assign({},e,{type:"text",name:"endsAt",id:"endsAt"}))}))),r.a.createElement("hr",null),t.map(function(t){return r.a.createElement(r.a.Fragment,{key:t.id},r.a.createElement("h2",null,t.name+" "+t.surname),t.subjects.map(function(t){return r.a.createElement(E.m,{key:t.id,bordered:!0},r.a.createElement("caption",null,t.name),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Group Name"),r.a.createElement("th",null,"Students"),r.a.createElement("th",null,"Phone"),e.state.weekDays.map(function(e){return r.a.createElement("th",{key:e.id},e.name)}))),r.a.createElement("tbody",null,t.groups.map(function(t){return t.students.map(function(n,a,s){return r.a.createElement("tr",{key:n.id},!a&&r.a.createElement("td",{rowSpan:s.length},t.name),r.a.createElement("td",null,n.name," ",n.surname),r.a.createElement("td",null,n.phone),!a&&e.state.weekDays.map(function(e){return r.a.createElement("td",{rowSpan:s.length,key:e.id},t.days.some(function(t){return t.id===e.id})?t.days.find(function(t){return t.id===e.id}).startsAt:"")}))})})))}))}))}},{key:"changeState",value:function(e,t){this.setState(Object(b.a)({},e,t))}}]),t}(r.a.Component)),W=["/home","/timetable"],_="https://colibri-training.herokuapp.com/api",M=[{path:"/home",name:"Home",component:p},{path:"/users",name:"Users",component:C},{path:"/students",name:"Students",component:I},{path:"/subjects",name:"Subjects",component:U},{path:"/groups",name:"Groups",component:L},{path:"/timetable",name:"Time table",component:q}],H={ACTIVE:0,ARCHIVED:1,PENDING:2},V=M.filter(function(e){return W.some(function(t){return t===e.path})}),J=n(28),z={"Content-Type":"application/json"};function B(){return localStorage.getItem("token")}function X(){return Object.assign({Authorization:"Basic "+B()},z)}var Y=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getUsers",value:function(e){e&&"object"===typeof e||(e={});var t={};return["limit","offset"].forEach(function(n){n in e&&(t[n]=e[n])}),new Promise(function(e,n){A.get({url:"".concat(_,"/users"),headers:X(),params:t}).then(function(t){return e(t)},function(e){return n(e)})})}},{key:"getUser",value:function(e){return isNaN(e)?Promise.reject({message:"Invalid id"}):new Promise(function(t,n){A.get({url:"".concat(_,"/users/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"checkUser",value:function(){return B()?new Promise(function(e,t){A.get({url:"".concat(_,"/users/check"),headers:X()}).then(function(t){return e(t)},function(e){return t(e)})}):Promise.reject(null)}},{key:"authUser",value:function(e,t){return new Promise(function(n,a){A.post({url:"".concat(_,"/users/auth"),body:{username:e,password:t},headers:z}).then(function(e){return n(e)},function(e){return a(e)})})}},{key:"setUser",value:function(e){localStorage.setItem("token",e.token||""),localStorage.setItem("privilege",e.privilege)}},{key:"forgetUser",value:function(){return A.get({url:"".concat(_,"/users/logout"),headers:X()}).then(function(){return localStorage.removeItem("token")})}},{key:"addUser",value:function(e){return new Promise(function(t,n){if("object"!==typeof e)throw new Error("Object required");if(!B())return Promise.reject(null);A.post({url:"".concat(_,"/users"),body:e,headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"editUser",value:function(e,t){return new Promise(function(n,a){if("object"!==typeof t)throw new Error("Object required");if(isNaN(e))return Promise.reject({message:"Invalid id"});A.put({url:"".concat(_,"/users/").concat(e),body:t,headers:X()}).then(function(e){return n(e)},function(e){return a(e)})})}},{key:"deleteUser",value:function(e){return new Promise(function(t,n){if(isNaN(e))return Promise.reject({message:"Invalid id"});A.delete({url:"".concat(_,"/users/").concat(e),headers:X()}).then(function(e){return t(e)},function(e){return n(e)})})}},{key:"getHeaders",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?X():z}},{key:"isAdminAuthorized",value:function(){return Number(localStorage.getItem("privilege"))===J.ADMIN_PERMISSION}}]),e}(),K=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={username:"",password:"",redirect:null},Y.checkUser().then(function(){n.setState({redirect:!0})},function(){n.setState({redirect:!1})}),n.logIn=n.logIn.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"logIn",value:function(e){var t=this;for(var n in e.preventDefault(),this.state)if("redirect"!==n&&!this.state[n])return void alert("".concat(n.replace(/^./,function(e){return e.toUpperCase()})," is missing"));Y.authUser(this.state.username,this.state.password).then(function(e){Y.setUser(e),t.setState({redirect:!0})})}},{key:"render",value:function(){var e=this;switch(this.state.redirect){case null:return null;case!0:return r.a.createElement(f.a,{to:"/home"});default:return r.a.createElement("form",{onSubmit:this.logIn,className:"auth"},r.a.createElement("div",{className:"container"},r.a.createElement("label",null,r.a.createElement("b",null,"Username")),r.a.createElement("input",{type:"text",placeholder:"Enter Username",onInput:function(t){return e.setState({username:t.target.value})},required:!0}),r.a.createElement("label",null,r.a.createElement("b",null,"Password")),r.a.createElement("input",{type:"password",placeholder:"Enter Password",onInput:function(t){return e.setState({password:t.target.value})},required:!0}),r.a.createElement("button",{type:"submit"},"Login")))}}}]),t}(r.a.Component),Q=n(59),Z=(n(56),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).routes=Y.isAdminAuthorized()?M:V,n.state={redirect:!1},n.nav=null,n.logOut=n.logOut.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"logOut",value:function(e){var t=this;e.preventDefault(),Y.forgetUser().then(function(){t.setState({redirect:!0})})}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(f.a,{to:"/"}):r.a.createElement("header",{className:"header-fixed"},r.a.createElement("div",{className:"header-limiter text-left"},r.a.createElement(Q.a,{to:"/home"},r.a.createElement("img",{className:"logo",src:"/img/logo.png",alt:"Logo"})),r.a.createElement("nav",{ref:this.nav},this.routes.map(function(t){return r.a.createElement(Q.a,{key:t.path,to:t.path,className:e.props.path.includes(t.path)?"selected":null},t.name)}),r.a.createElement("a",{href:"#",onClick:this.logOut},"Log out"))))}}]),t}(r.a.Component)),$=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={component:null},Y.checkUser().then(function(){n.setState({component:"/"===window.location.pathname?r.a.createElement(f.a,{to:"/home"}):t.renderMain()})},function(){n.setState({component:"/"!==window.location.pathname?r.a.createElement(f.a,{to:"/"}):t.renderMain()})}),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.component;return this.state.component=t.renderMain(),e}}],[{key:"renderMain",value:function(){var e=M.map(function(e){return r.a.createElement(g.a,{key:e.path,path:e.path,component:e.component})});return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{path:"/",render:function(e){return e.match.isExact?r.a.createElement(K,null):r.a.createElement(Z,{path:e.location.pathname})}}),r.a.createElement("main",{className:"container"},e))}}]),t}(r.a.Component);o.a.render(r.a.createElement(c.a,null,r.a.createElement(function(){return r.a.createElement($,null)},null)),document.getElementById("root"))}},[[29,2,1]]]);
//# sourceMappingURL=main.e91eae77.chunk.js.map